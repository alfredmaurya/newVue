(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"6f7c":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("visi-dialog",{attrs:{dialog:e.dialog,title:e.title,"show-footer":"",cardClass:"q-card-md",beforeShow:e.beforeShow,loading:e.loading,onHide:e.onHide,onSubmit:e.onSubmit,submitting:e.submitting},scopedSlots:e._u([{key:"ScrollContent",fn:function(){return[i("div",{staticClass:"form q-pa-md"},[i("div",{staticClass:"row q-col-gutter-md"},[i("div",{staticClass:"col-12 col-md-12"},[i("div",{staticClass:"form-field q-pb-none"},[i("div",{staticClass:"alert bg-light-primary text-primary"},[e._v("\n              *Required Fields\n              ")])])]),i("div",{staticClass:"col-12 col-md-12"},[i("div",{staticClass:"form-field q-pb-none"},[i("q-input",{attrs:{outlined:"",label:"Accommodation Name*","lazy-rules":"",rules:[e.$rules.required()]},model:{value:e.detail.title,callback:function(t){e.$set(e.detail,"title","string"===typeof t?t.trim():t)},expression:"detail.title"}})],1)]),i("div",{staticClass:"col-12 col-md-12"},[i("div",{staticClass:"form-field__area q-pb-none"},[i("q-input",{attrs:{outlined:"",label:"Description",type:"textarea",autogrow:""},model:{value:e.detail.description,callback:function(t){e.$set(e.detail,"description","string"===typeof t?t.trim():t)},expression:"detail.description"}})],1)]),i("div",{staticClass:"col-12 col-md-6"},[i("div",{staticClass:"form-field q-pb-none"},[i("q-select",{attrs:{outlined:"",label:"Select Location*","lazy-rules":"",options:e.locationOptions,rules:[e.$rules.required()],"option-label":"title","option-value":"id","emit-value":"","map-options":"","use-input":""},on:{filter:e.filterLocation,input:e.onLocationChange},scopedSlots:e._u([{key:"no-option",fn:function(){return[i("q-item",[i("q-item-section",{staticClass:"text-grey"},[e._v("\n                    No results\n                  ")])],1)]},proxy:!0}]),model:{value:e.detail.location_id,callback:function(t){e.$set(e.detail,"location_id",t)},expression:"detail.location_id"}})],1)]),i("div",{staticClass:"col-12 col-md-6"},[i("div",{staticClass:"form-field q-pb-none"},[i("q-select",{attrs:{outlined:"",label:"Select Park*","lazy-rules":"",options:e.parkOptions,rules:[e.$rules.required()],"option-label":"title","option-value":"id","emit-value":"","map-options":"","use-input":"",loading:e.loadingParks},on:{filter:e.filterPark},scopedSlots:e._u([{key:"no-option",fn:function(){return[i("q-item",[i("q-item-section",{staticClass:"text-grey"},[e._v("\n                    No results\n                  ")])],1)]},proxy:!0}]),model:{value:e.detail.park_id,callback:function(t){e.$set(e.detail,"park_id",t)},expression:"detail.park_id"}})],1)]),i("div",{staticClass:"col-6 col-md-6"},[i("div",{staticClass:"form-field q-pb-none"},[i("q-toggle",{attrs:{label:"Active","left-label":"","true-value":1,"false-value":0,"checked-icon":"check","unchecked-icon":"clear",size:"lg"},model:{value:e.detail.status,callback:function(t){e.$set(e.detail,"status",t)},expression:"detail.status"}})],1)]),i("div",{staticClass:"col-12 col-md-6"},[i("div",{staticClass:"form-field q-pb-none"},[i("q-select",{attrs:{outlined:"",label:"Select Subtype*","lazy-rules":"",options:e.subTypeOptions,rules:[e.$rules.required()],"option-label":"title","option-value":"id","emit-value":"","map-options":"","use-input":"",loading:e.loadingSubtypes},scopedSlots:e._u([{key:"no-option",fn:function(){return[i("q-item",[i("q-item-section",{staticClass:"text-grey"},[e._v("\n                    No results\n                  ")])],1)]},proxy:!0}]),model:{value:e.detail.subtype_id,callback:function(t){e.$set(e.detail,"subtype_id",t)},expression:"detail.subtype_id"}})],1)]),i("div",{staticClass:"col-12 col-md-12"},[i("div",{staticClass:"form-field q-pb-none"},[i("q-toggle",{attrs:{label:"Set Price Rule","left-label":"","true-value":1,"false-value":0,"checked-icon":"check","unchecked-icon":"clear",size:"lg"},model:{value:e.detail.is_price_rule,callback:function(t){e.$set(e.detail,"is_price_rule",t)},expression:"detail.is_price_rule"}})],1)]),e.detail.is_price_rule?i("div",{staticClass:"col-12 col-md-12"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-6 text-left date-pick-col"},[i("div",{staticClass:"q-pa-md date-pick"},[i("q-input",{attrs:{filled:"",mask:"date",rules:["date"],label:"Rule Start Date:*"},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[i("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[i("q-date",{model:{value:e.start_date,callback:function(t){e.start_date=t},expression:"start_date"}},[i("div",{staticClass:"row items-center justify-end"},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}],null,!1,3568326034),model:{value:e.start_date,callback:function(t){e.start_date=t},expression:"start_date"}})],1)]),i("div",{staticClass:"col-md-6 date-pick-col"},[i("div",{staticClass:"q-pa-md date-pick"},[i("q-input",{attrs:{filled:"",mask:"date",rules:["date"],label:"Rule End Date:*"},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[i("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[i("q-date",{model:{value:e.end_date,callback:function(t){e.end_date=t},expression:"end_date"}},[i("div",{staticClass:"row items-center justify-end"},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}],null,!1,3151513469),model:{value:e.end_date,callback:function(t){e.end_date=t},expression:"end_date"}})],1)])]),i("q-list",{attrs:{bordered:"",separator:""}},[e._l(e.priceRule,(function(t,a){return i("q-item",{key:""+a,staticClass:"q-py-md row q-col-gutter-sm",staticStyle:{"flex-wrap":"wrap !important"},attrs:{wrap:""}},[i("div",{staticClass:"col-12 col-md-5"},[i("div",{staticClass:"form-field q-pb-none"},[i("q-select",{attrs:{outlined:"",label:"Frequency*","lazy-rules":"",rules:[e.$rules.required()],options:Object.values(e.frequencyOptions),"map-options":"","emit-value":""},model:{value:t.frequency,callback:function(i){e.$set(t,"frequency",i)},expression:"priceRu.frequency"}})],1)]),i("div",{staticClass:"col-12 col-md-3"},[i("div",{staticClass:"form-field q-pb-none"},[i("q-input",{attrs:{outlined:"",label:"Rate*",prefix:"$",mask:"#######","lazy-rules":"",rules:[e.$rules.required(),e.$rules.decimal("Enter valid Price.")]},model:{value:t.rate,callback:function(i){e.$set(t,"rate",i)},expression:"priceRu.rate"}})],1)]),i("div",{staticClass:"col-12 col-md-1"},[i("div",{staticClass:"form-field q-pb-none"},[i("q-btn",{attrs:{disabled:1==e.priceRule.length,unelevated:"",color:"red",size:"14px",padding:"11px",icon:"delete"},on:{click:function(t){return e.deleteRow(a)}}})],1)])])})),e.numRule<3?i("div",{staticClass:"q-px-md q-pb-md"},[i("q-btn",{attrs:{unelevated:"","no-caps":"",dense:"",size:"12px",padding:"8px 16px",color:"secondary"},on:{click:e.addRow}},[i("q-icon",{staticClass:"q-mr-sm",attrs:{name:"add"}}),e._v("Add Price Rule\n              ")],1)],1):e._e()],2)],1):e._e()])])]},proxy:!0}])})},s=[],l=i("7037"),o=i.n(l),n=i("ded3"),r=i.n(n),c=(i("a434"),i("d3b7"),i("e6cf"),i("a79d"),i("4de4"),i("e9c4"),i("ac1f"),i("5319"),i("5b81"),i("cca6"),i("2f62")),d=i("bd4c");function u(){var e=Date.now(),t=Date.now()+2592e5;return e=d["b"].formatDate(e,"YYYY/MM/DD"),t=d["b"].formatDate(t,"YYYY/MM/DD"),{dialog:"AccommodationForm",title:"Add Accommodation",frequencyOptions:{daily:{label:"Daily",value:1,extraLabel:"Days"},weekly:{label:"Weekly",value:2,extraLabel:"Weeks"},monthly:{label:"Monthly",value:3,extraLabel:"Months"}},start_date:e,end_date:t,numRule:1,priceRule:[{frequency:1,rate:""}],detail:{title:"",description:"",park_id:"",location_id:"",status:1,subtype_id:0,is_price_rule:0},loading:!1,submitting:!1,locationOptions:[],parkOptions:[],subTypeOptions:[{id:0,title:"None"},{id:1,title:"RVS"},{id:2,title:"Cabins"}],parks:{},loadingParks:!1,loadingSubtypes:!1}}var p={name:"AccommodationForm",data:u,computed:r()(r()({},Object(c["b"])("common",["locations"])),{},{properties:function(){return this.getDialogProperties(this.dialog)}}),methods:{addRow:function(){this.numRule<3&&(this.numRule+=1,this.priceRule.push({frequency:this.numRule,rate:""}))},deleteRow:function(e){this.priceRule&&this.priceRule.length>1&&(this.priceRule.splice(e,1),this.numRule-=1)},onLocationChange:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(i||(this.detail.park_id=""),this.parks[e])return this.parks[e];i&&(this.loading=!0),this.loadingParks=!0,this.$store.dispatch("parks/getListing",{pagination:0,location_id:e}).then((function(i){i.status&&i.data&&(t.parkOptions=t.parks[e]=i.data)})).finally((function(){t.loadingParks=!1,t.loading=!1}))},filterLocation:function(e,t){var i=this;t(""!==e?function(){var t=e.toLowerCase();i.locationOptions=i.locations.filter((function(e){return e.title.toLowerCase().indexOf(t)>-1}))}:function(){i.locationOptions=i.locations,console.log(i.locationOptions)})},filterPark:function(e,t){var i=this,a=this.parks[this.detail.location_id]||[];t(""!==e?function(){var t=e.toLowerCase();i.parkOptions=a.filter((function(e){return e.title.toLowerCase().indexOf(t)>-1}))}:function(){i.parkOptions=a})},beforeShow:function(){if(this.properties.id){this.title="Edit Accommodation";var e=JSON.parse(JSON.stringify(this.properties));if(e.price_rule&&e.price_rule.length){this.priceRule=e.price_rule;var t=e.price_rule[0].date_from,i=e.price_rule[0].date_to;t=t.replaceAll("-","/"),i=i.replaceAll("-","/"),this.start_date=t,this.end_date=i,this.numRule=e.price_rule.length}else if(this.properties.rule&&this.properties.price_rule.length){this.priceRule=this.properties.price_rule;t=this.properties.rule[0].date_from,i=this.properties.rule[0].date_to;t=t.replaceAll("-","/"),i=i.replaceAll("-","/"),this.start_date=t,this.end_date=i,this.numRule=this.properties.price_rule.length}e.is_price_rule=e.price_rule&&e.price_rule.length?1:0,this.detail=e,this.onLocationChange(e.location_id,!0),this.locationOptions=this.locations}},onHide:function(){Object.assign(this.$data,u())},onSubmit:function(){var e=this;this.submitting=!0;var t=r()(r()({},this.detail),{},{priceRule:this.priceRule,date_from:this.start_date,date_to:this.end_date});this.$store.dispatch("accommodation/addUpdate",t).then((function(t){if(t.status)e.updateDialogState({dialog:"AccommodationForm",val:!1}),e.showSuccess(t.message);else if(t.message)if("object"===o()(t.message))for(var i in t.message)e.showError(t.message[i]);else("string"===typeof t.message||t.message instanceof String)&&e.showError(t.message)})).finally((function(){e.submitting=!1}))}}},f=p,m=(i("8d19"),i("2877")),v=i("f09f"),b=i("27f9"),h=i("ddd8"),_=i("66e5"),g=i("4074"),q=i("9564"),y=i("0016"),k=i("7cbe"),C=i("52ee"),x=i("9c40"),w=i("1c1c"),R=i("7f67"),S=i("eebe"),O=i.n(S),$=Object(m["a"])(f,a,s,!1,null,null,null);t["default"]=$.exports;O()($,"components",{QCard:v["a"],QInput:b["a"],QSelect:h["a"],QItem:_["a"],QItemSection:g["a"],QToggle:q["a"],QIcon:y["a"],QPopupProxy:k["a"],QDate:C["a"],QBtn:x["a"],QList:w["a"]}),O()($,"directives",{ClosePopup:R["a"]})},"8d19":function(e,t,i){"use strict";i("f6ec")},f6ec:function(e,t,i){}}]);